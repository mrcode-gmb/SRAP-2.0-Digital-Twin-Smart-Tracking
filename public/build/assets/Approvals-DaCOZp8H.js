import{j as e}from"./ui--EPVQjIL.js";import{R as s,r as a,H as r}from"./inertia-Cj_WjKpf.js";import{A as t,a as l,b as i,C as n}from"./AuthenticatedLayout-DyY7H2xW.js";import{u as d,C as c,b as o}from"./app-BL8QhPge.js";import{C as m,a as x,b as h,c as p,d as j}from"./Card-BDwu8o3f.js";import{c as g,B as u}from"./Button-DAnlAX8y.js";import{C as y}from"./clock-COuS2uwh.js";import{T as f,U as N,D as b}from"./users-CnFZ8Cqn.js";import{m as v}from"./motion-CwjCYErC.js";import"./vendor-vi784Xxu.js";import"./utils-54zDqgmH.js";import"./house-ChXd5_0Q.js";import"./shield-B1vXgKnl.js";import"./zap-AXpzjYI9.js";const w=s.forwardRef(({className:s,...a},r)=>e.jsx("textarea",{className:g("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:r,...a}));function k({auth:s}){const{showSuccess:g,showError:k}=d(),[P,C]=a.useState([]),[S,R]=a.useState(!0),[A,T]=a.useState(""),[D,F]=a.useState(null);a.useEffect(()=>{K()},[]);const K=async()=>{try{const e=await fetch("/admin/progress-upload/pending-approvals",{headers:{"X-Requested-With":"XMLHttpRequest"}}),s=await e.json();C(s.data||[])}catch(e){k("Failed to fetch pending approvals")}finally{R(!1)}},O=e=>{const s={pending:"bg-yellow-100 text-yellow-800 border-yellow-200",verified:"bg-green-100 text-green-800 border-green-200",rejected:"bg-red-100 text-red-800 border-red-200"};return s[e]||s.pending};return e.jsxs(t,{user:s.user,children:[e.jsx(r,{title:"Pending Approvals - HOD Dashboard"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Pending Approvals"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Review and approve KPI progress submissions from your department"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(l,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:[e.jsx(y,{className:"w-4 h-4 mr-1"}),P.length," Pending"]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(m,{children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(y,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Pending Approval"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:P.length})]})]})})}),e.jsx(m,{children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(c,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Approved Today"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"0"})]})]})})}),e.jsx(m,{children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(f,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Department KPIs"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"-"})]})]})})})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsxs(p,{className:"flex items-center",children:[e.jsx(i,{className:"w-5 h-5 mr-2 text-yellow-600"}),"Submissions Requiring Approval"]}),e.jsx(j,{children:"Review KPI progress data submitted by Data Officers"})]}),e.jsx(x,{children:S?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Loading pending approvals..."})]}):0===P.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(c,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Pending Approvals"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"All submissions have been reviewed. Great work!"})]}):e.jsx("div",{className:"space-y-4",children:P.map(s=>e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white",children:s.kpi?.name||"KPI Progress Update"}),e.jsx(l,{className:O(s.verification_status),children:s.verification_status})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),s.reported_by?.name||"Unknown"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(n,{className:"w-4 h-4 mr-1"}),new Date(s.reporting_date).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"w-4 h-4 mr-1"}),"Value: ",s.value]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{className:"w-4 h-4 mr-1"}),s.source]})]}),s.notes&&e.jsxs("div",{className:"mt-2 p-2 bg-gray-100 dark:bg-gray-700 rounded text-sm",children:[e.jsx("strong",{children:"Notes:"})," ",s.notes]})]}),e.jsxs("div",{className:"flex space-x-2 ml-4",children:[e.jsxs(u,{onClick:()=>(async e=>{try{const s=await fetch(`/admin/progress-upload/${e}/approve`,{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,"Content-Type":"application/json"}}),a=await s.json();s.ok?(g("Progress entry approved successfully"),K()):k(a.error||"Failed to approve entry")}catch(s){k("Failed to approve entry")}})(s.id),className:"bg-green-600 hover:bg-green-700 text-white",size:"sm",children:[e.jsx(c,{className:"w-4 h-4 mr-1"}),"Approve"]}),e.jsxs(u,{onClick:()=>F(s),variant:"outline",className:"border-red-300 text-red-600 hover:bg-red-50",size:"sm",children:[e.jsx(o,{className:"w-4 h-4 mr-1"}),"Reject"]})]})]})},s.id))})})]}),D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Reject Submission"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Please provide a reason for rejecting this KPI progress submission:"}),e.jsx(w,{value:A,onChange:e=>T(e.target.value),placeholder:"Enter rejection reason...",className:"mb-4",rows:3}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(u,{onClick:()=>(async e=>{if(A.trim())try{const s=await fetch(`/admin/progress-upload/${e}/reject`,{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,"Content-Type":"application/json"},body:JSON.stringify({rejection_reason:A})}),a=await s.json();s.ok?(g("Progress entry rejected"),F(null),T(""),K()):k(a.error||"Failed to reject entry")}catch(s){k("Failed to reject entry")}else k("Please provide a rejection reason")})(D.id),className:"bg-red-600 hover:bg-red-700 text-white flex-1",children:"Reject"}),e.jsx(u,{onClick:()=>{F(null),T("")},variant:"outline",className:"flex-1",children:"Cancel"})]})]})})]})})]})}w.displayName="Textarea";export{k as default};
