import{j as e}from"./ui-BB-Ns5TH.js";import{u as r,r as s,b as a,H as t,d as l}from"./inertia-Cj_WjKpf.js";import{A as i,U as d,T as n,a as c,b as o}from"./AuthenticatedLayout-BBLrwm4R.js";import{u as x,X as m,C as p}from"./app-CZ5g9MqA.js";import{C as h,b as g,c as u,d as j,a as y}from"./Card-Ds6DZKCN.js";import{B as b}from"./Button-WmfceJNP.js";import{m as f}from"./motion-CkVjjaNW.js";import{A as k}from"./arrow-left-Dg9xWZOv.js";import{B as N,C as w}from"./users-Vk9iYAaE.js";import{Z as v}from"./zap-BuVIDKNS.js";import{F as _}from"./file-spreadsheet-DDwUCLB_.js";import{C as P}from"./clock-CUBuh0Xb.js";import{D as S}from"./download-CAAPgHvN.js";import"./vendor-vi784Xxu.js";import"./utils-54zDqgmH.js";import"./house-CIkpS4mx.js";import"./shield-BVGIsKr8.js";function C({kpis:C=[]}){const{showSuccess:D,showError:I,showWarning:A}=x(),{flash:B}=r().props,[E,z]=s.useState(!1),[R,U]=s.useState(null),[q,F]=s.useState("manual"),[M,T]=s.useState(null),{data:K,setData:L,post:O,processing:V,errors:G,progress:H}=a({kpi_id:"",progress:"",budget_utilization:"",delay_days:"",stakeholder_engagement_score:"",ai_predicted_success:"",file:null,overwrite_existing:!1});s.useEffect(()=>{if(B?.success&&D(B.success),B?.error&&I(B.error),B?.warning&&A(B.warning),B?.prediction_results){const e=B.prediction_results;T(e),e.error_count>0&&A(`Bulk prediction completed with ${e.error_count} errors. Check the details for more information.`)}},[B,D,I,A]);const W=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?z(!0):"dragleave"===e.type&&z(!1)};return e.jsxs(i,{children:[e.jsx(t,{title:"Create AI Prediction"}),e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto",children:[e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mb-8",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>l.get("/admin/ai-predictions"),className:"flex items-center space-x-2",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:"Back"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500 to-blue-600 rounded-xl",children:e.jsx(N,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Create AI Risk Prediction"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Generate AI-powered risk assessments for KPI performance"})]})]})]})})}),e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"mb-8",children:e.jsxs(h,{children:[e.jsxs(g,{children:[e.jsx(u,{children:"Prediction Mode"}),e.jsx(j,{children:"Choose between manual input or bulk file upload"})]}),e.jsx(y,{children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>F("manual"),className:"flex-1 p-4 rounded-lg border-2 transition-all "+("manual"===q?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300"),children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"mx-auto h-8 w-8 mb-2 "+("manual"===q?"text-purple-600":"text-gray-400")}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Manual Input"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Enter parameters manually for single prediction"})]})}),e.jsx("button",{onClick:()=>F("bulk"),className:"flex-1 p-4 rounded-lg border-2 transition-all "+("bulk"===q?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300"),children:e.jsxs("div",{className:"text-center",children:[e.jsx(_,{className:"mx-auto h-8 w-8 mb-2 "+("bulk"===q?"text-purple-600":"text-gray-400")}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Bulk Upload"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Upload Excel/CSV file for multiple predictions"})]})})]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:"manual"===q?e.jsx(f.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2},children:e.jsxs(h,{children:[e.jsxs(g,{children:[e.jsxs(u,{className:"flex items-center space-x-2",children:[e.jsx(N,{className:"w-5 h-5"}),e.jsx("span",{children:"Manual Prediction Input"})]}),e.jsx(j,{children:"Enter KPI parameters for AI risk assessment"})]}),e.jsx(y,{children:e.jsxs("form",{onSubmit:e=>{e.preventDefault(),K.kpi_id?O(route("admin.ai-predictions.store"),{onStart:()=>{D("Processing AI prediction...")},onSuccess:()=>{D("AI prediction completed successfully!")},onError:e=>{Object.keys(e).length>0?I("Please check the form for errors"):I("Prediction failed. Please try again.")}}):I("Please select a KPI")},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select KPI *"}),e.jsxs("select",{value:K.kpi_id,onChange:e=>L("kpi_id",e.target.value),className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Choose a KPI..."}),C.map(r=>e.jsxs("option",{value:r.id,children:[r.name," (",r.current_value,"/",r.target_value,")"]},r.id))]}),G.kpi_id&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:G.kpi_id})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Progress (%) *"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"100",value:K.progress,onChange:e=>L("progress",e.target.value),className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 py-2",placeholder:"e.g., 75.5",required:!0}),G.progress&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:G.progress})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Budget Utilization (%) *"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"200",value:K.budget_utilization,onChange:e=>L("budget_utilization",e.target.value),className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 py-2",placeholder:"e.g., 85.0",required:!0}),G.budget_utilization&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:G.budget_utilization})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Delay Days *"}),e.jsx("input",{type:"number",min:"0",value:K.delay_days,onChange:e=>L("delay_days",e.target.value),className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 py-2",placeholder:"e.g., 5",required:!0}),G.delay_days&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:G.delay_days})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Stakeholder Engagement Score *"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"10",value:K.stakeholder_engagement_score,onChange:e=>L("stakeholder_engagement_score",e.target.value),className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 py-2",placeholder:"e.g., 8.5",required:!0}),G.stakeholder_engagement_score&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:G.stakeholder_engagement_score})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"AI Predicted Success (%) *"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"100",value:K.ai_predicted_success,onChange:e=>L("ai_predicted_success",e.target.value),className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 py-2",placeholder:"e.g., 82.0",required:!0}),G.ai_predicted_success&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:G.ai_predicted_success})]}),e.jsx(b,{type:"submit",disabled:V,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:V?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing Prediction..."]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Generate AI Prediction"]})})]})})]})}):e.jsx(f.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2},children:e.jsxs(h,{children:[e.jsxs(g,{children:[e.jsxs(u,{className:"flex items-center space-x-2",children:[e.jsx(d,{className:"w-5 h-5"}),e.jsx("span",{children:"Bulk Prediction Upload"})]}),e.jsx(j,{children:"Upload Excel/CSV file for multiple AI predictions"})]}),e.jsx(y,{children:e.jsxs("form",{onSubmit:e=>{e.preventDefault(),R?O(route("admin.ai-predictions.bulk"),{onStart:()=>{D("Starting bulk prediction processing...")},onSuccess:()=>{U(null),L("file",null)},onError:e=>{e.file?I(e.file):I("Bulk prediction failed. Please check your file and try again.")}}):I("Please select a file to upload")},className:"space-y-6",children:[e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors "+(E?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400"),onDragEnter:W,onDragLeave:W,onDragOver:W,onDrop:e=>{if(e.preventDefault(),e.stopPropagation(),z(!1),e.dataTransfer.files&&e.dataTransfer.files[0]){const r=e.dataTransfer.files[0];U(r),L("file",r)}},children:[e.jsx(d,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Drop your file here, or"," ",e.jsxs("label",{className:"text-purple-600 hover:text-purple-700 cursor-pointer",children:["browse",e.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls,.csv",onChange:e=>{if(e.target.files&&e.target.files[0]){const r=e.target.files[0];U(r),L("file",r)}}})]})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Excel (.xlsx, .xls) or CSV files only. Max 10MB."}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"Required columns: Progress (%), Budget_Utilization (%), Delay_Days, Stakeholder_Engagement_Score, AI_Predicted_Success (%)"})]}),R&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(_,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900 dark:text-green-100",children:R.name}),e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400",children:[(R.size/1024/1024).toFixed(2)," MB"]})]}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>U(null),children:e.jsx(m,{className:"w-4 h-4"})})]})]}),G.file&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded-lg p-4",children:e.jsx("p",{className:"text-red-600 dark:text-red-400",children:G.file})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"overwrite",checked:K.overwrite_existing,onChange:e=>L("overwrite_existing",e.target.checked),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("label",{htmlFor:"overwrite",className:"text-sm text-gray-700 dark:text-gray-300",children:"Overwrite existing predictions for same parameters"})]}),e.jsx(b,{type:"submit",disabled:V||!R,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:V?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing Bulk Predictions..."]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"w-4 h-4 mr-2"}),"Upload & Process"]})})]})})]})})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.3},children:e.jsxs(h,{children:[e.jsx(g,{children:e.jsxs(u,{className:"flex items-center space-x-2",children:[e.jsx(S,{className:"w-5 h-5"}),e.jsx("span",{children:"Template"})]})}),e.jsxs(y,{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Download the Excel template with required columns and sample data."}),e.jsxs(b,{onClick:()=>{try{window.open("/admin/ai-predictions/template","_blank"),D("Template download started")}catch(e){I("Failed to download template. Please try again.")}},variant:"outline",className:"w-full",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Download Template"]})]})]})}),e.jsx(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.4},children:e.jsxs(h,{children:[e.jsx(g,{children:e.jsx(u,{children:"Required Parameters"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(n,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:"Progress (%): 0-100"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Budget Utilization (%): 0-200"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{children:"Delay Days: 0+"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{children:"Engagement Score: 0-10"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{className:"w-4 h-4 text-indigo-500"}),e.jsx("span",{children:"AI Success (%): 0-100"})]})]})})]})}),e.jsx(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.5},children:e.jsxs(h,{children:[e.jsx(g,{children:e.jsx(u,{children:"Risk Assessment"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Low Risk"})]}),e.jsx(c,{className:"bg-green-100 text-green-800 border-green-200",children:"0-3.9"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-sm",children:"Medium Risk"})]}),e.jsx(c,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"4.0-6.9"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-sm",children:"High Risk"})]}),e.jsx(c,{className:"bg-red-100 text-red-800 border-red-200",children:"7.0-10"})]})]})})]})})]}),M&&M.predictions&&M.predictions.length>0&&e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"mt-8",children:e.jsxs(h,{children:[e.jsx(g,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(u,{className:"flex items-center space-x-2",children:[e.jsx(p,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{children:"Prediction Results"})]}),e.jsx(j,{children:"Preview of predictions (first 10 rows)"})]}),M.download_link&&e.jsxs(b,{variant:"outline",onClick:()=>window.open(M.download_link,"_blank"),className:"bg-yellow-500 hover:bg-yellow-600 text-white border-yellow-500",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Download Results"]})]})}),e.jsxs(y,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border border-gray-200 dark:border-gray-700",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-800",children:[e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-left font-medium text-gray-900 dark:text-white",children:"Progress (%)"}),e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-left font-medium text-gray-900 dark:text-white",children:"Budget Utilization (%)"}),e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-left font-medium text-gray-900 dark:text-white",children:"Delay Days"}),e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-left font-medium text-gray-900 dark:text-white",children:"Stakeholder Engagement Score"}),e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-left font-medium text-gray-900 dark:text-white",children:"AI Predicted Success (%)"}),e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-left font-medium text-gray-900 dark:text-white",children:"Predicted Risk"})]})}),e.jsx("tbody",{children:M.predictions.slice(0,10).map((r,s)=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-gray-900 dark:text-white",children:r.progress}),e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-gray-900 dark:text-white",children:r.budget_utilization}),e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-gray-900 dark:text-white",children:r.delay_days}),e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-gray-900 dark:text-white",children:r.stakeholder_engagement_score}),e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-gray-900 dark:text-white",children:r.ai_predicted_success}),e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2",children:e.jsx(c,{className:"Low"===r.predicted_risk?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300":"Medium"===r.predicted_risk?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300",children:r.predicted_risk})})]},s))})]})}),M.predictions.length>10&&e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing first 10 of ",M.predictions.length," predictions.",e.jsx("br",{}),"Download the full results file to see all predictions."]})})]})]})})]})]})]})}export{C as default};
