import{j as e}from"./ui--EPVQjIL.js";import{r as s,H as t,L as r,d as a}from"./inertia-Cj_WjKpf.js";import{A as l,a as n,F as i,C as o}from"./AuthenticatedLayout-rIECtlsZ.js";import{F as d}from"./funnel-Caub1zvl.js";import{m as c}from"./motion-CwjCYErC.js";import{D as m}from"./download-Bq8EvEAx.js";import{E as x}from"./eye-DDnAUwaJ.js";import{F as h}from"./file-spreadsheet-DFK-ovrs.js";import{R as p}from"./refresh-cw-Borcl97a.js";import{P as u}from"./plus-CxyHirwb.js";import{C as g}from"./clock-C9IOtF09.js";import{b as j,C as f}from"./app-mKMKGM5i.js";import"./vendor-vi784Xxu.js";import"./utils-54zDqgmH.js";import"./Button-DAnlAX8y.js";import"./house-V8upMmDd.js";import"./users-h2zC9xgO.js";function b({auth:b,reports:y,filters:v}){const[w,N]=s.useState(v?.search||""),[_,C]=s.useState(v?.status||""),[S,k]=s.useState(v?.type||""),R=async(e,s)=>{if(e.pdf_path||e.excel_path)try{const t=await fetch(`/admin/reports/${e.id}/download/${s}`,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});if(!t.ok)throw new Error("Download failed");const r=await t.blob(),l=window.URL.createObjectURL(r),n=document.createElement("a");n.href=l,n.download=`${e.title}_${s}.${"pdf"===s?"pdf":"xlsx"}`,document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(l),a.reload({only:["reports"]})}catch(t){alert("Failed to download report. Please try again.")}else alert("No files available for download yet.")},P=s=>{switch(s){case"completed":return e.jsx(f,{className:"w-4 h-4 text-green-500"});case"generating":return e.jsx(p,{className:"w-4 h-4 text-blue-500 animate-spin"});case"failed":return e.jsx(j,{className:"w-4 h-4 text-red-500"});default:return e.jsx(g,{className:"w-4 h-4 text-yellow-500"})}},D=e=>{switch(e){case"completed":return"bg-green-100 text-green-800";case"generating":return"bg-blue-100 text-blue-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-yellow-100 text-yellow-800"}},F=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs(l,{user:b.user,header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Reports Management"}),e.jsxs(r,{href:"/admin/reports/create",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors",children:[e.jsx(u,{className:"w-4 h-4"}),e.jsx("span",{children:"Create Report"})]})]}),children:[e.jsx(t,{title:"Reports Management"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow-xl sm:rounded-lg mb-6",children:e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:e=>{e.preventDefault(),a.get("/admin/reports",{search:w,status:_,type:S},{preserveState:!0})},className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search reports...",value:w,onChange:e=>N(e.target.value),className:"pl-10 w-full border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("select",{value:_,onChange:e=>C(e.target.value),className:"border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"generating",children:"Generating"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"})]}),e.jsxs("select",{value:S,onChange:e=>k(e.target.value),className:"border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"kpi_summary",children:"KPI Summary"}),e.jsx("option",{value:"pillar_progress",children:"Pillar Progress"}),e.jsx("option",{value:"department_performance",children:"Department Performance"}),e.jsx("option",{value:"milestone_status",children:"Milestone Status"}),e.jsx("option",{value:"comprehensive",children:"Comprehensive"})]}),e.jsxs("button",{type:"submit",className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg flex items-center justify-center space-x-2 transition-colors",children:[e.jsx(d,{className:"w-4 h-4"}),e.jsx("span",{children:"Filter"})]})]})})}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:y.data.map((s,t)=>{return e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"bg-white overflow-hidden shadow-xl rounded-lg hover:shadow-2xl transition-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:s.title}),e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[P(s.status),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${D(s.status)}`,children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})]})]})}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(i,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:(l=s.type,{kpi_summary:"KPI Summary",pillar_progress:"Pillar Progress",department_performance:"Department Performance",milestone_status:"Milestone Status",comprehensive:"Comprehensive Report"}[l]||l)})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(o,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:[F(s.start_date)," - ",F(s.end_date)]})]}),s.download_count>0&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:[s.download_count," downloads"]})]})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[e.jsxs(r,{href:`/admin/reports/${s.id}`,className:"flex items-center text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors",children:[e.jsx(x,{className:"w-4 h-4 mr-1"}),"View Details"]}),"completed"===s.status&&e.jsxs("div",{className:"flex items-center space-x-2",children:[s.pdf_path&&e.jsx("button",{onClick:()=>R(s,"pdf"),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Download PDF",children:e.jsx(i,{className:"w-4 h-4"})}),s.excel_path&&e.jsx("button",{onClick:()=>R(s,"excel"),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Download Excel",children:e.jsx(h,{className:"w-4 h-4"})})]}),"generating"===s.status&&e.jsxs("div",{className:"flex items-center text-blue-600 text-sm",children:[e.jsx(p,{className:"w-4 h-4 mr-1 animate-spin"}),"Generating..."]}),"failed"===s.status&&e.jsx("button",{onClick:()=>a.post(`/admin/reports/${s.id}/regenerate`),className:"text-red-600 hover:text-red-800 text-sm font-medium transition-colors",children:"Try Again"})]})]})},s.id);var l})}),0===y.data.length&&e.jsx("div",{className:"bg-white overflow-hidden shadow-xl sm:rounded-lg",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(i,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Reports Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:w||_||S?"No reports match your current filters.":"Get started by creating your first report."}),e.jsxs(r,{href:"/admin/reports/create",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg inline-flex items-center space-x-2 transition-colors",children:[e.jsx(u,{className:"w-4 h-4"}),e.jsx("span",{children:"Create Report"})]})]})}),y.links&&y.links.length>3&&e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("nav",{className:"flex items-center space-x-2",children:y.links.map((s,t)=>e.jsx(r,{href:s.url||"#",className:"px-3 py-2 rounded-lg text-sm font-medium transition-colors "+(s.active?"bg-blue-600 text-white":s.url?"bg-white text-gray-700 hover:bg-gray-50 border border-gray-300":"bg-gray-100 text-gray-400 cursor-not-allowed"),dangerouslySetInnerHTML:{__html:s.label}},t))})})]})})]})}export{b as default};
