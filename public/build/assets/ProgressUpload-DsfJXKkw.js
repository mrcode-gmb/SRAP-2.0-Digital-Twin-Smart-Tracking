import{j as e}from"./ui-uJYCHPmv.js";import{u as s,r as a,H as r,L as t,d as l}from"./inertia-rR7Pl7wf.js";import{A as i,F as n,c as o,U as d,a as c,b as m}from"./AuthenticatedLayout-DdS3X_BT.js";import{u as x,C as p}from"./app-BwaKtS1U.js";import{C as u,b as g,c as h,d as j,a as y}from"./Card-CboSs8cY.js";import{B as f}from"./Button-ZWMNRGrJ.js";import{m as N}from"./motion-B4ydAICn.js";import{D as b}from"./download-BpLQjQtJ.js";import{P as v}from"./plus-DmYxx9CV.js";import{F as w}from"./funnel-uyWuM4Ux.js";import{E as k}from"./eye-CBpvo4zl.js";import{T as _}from"./trash-2-COEvf75q.js";import{C as P}from"./clock-DsiLXbLI.js";import"./vendor-vi784Xxu.js";import"./utils-54zDqgmH.js";import"./house-BZUBag7A.js";import"./users-DsjI5nqW.js";import"./shield-zrJRN7tf.js";import"./zap-DsGtfjvm.js";function C({uploads:C,filters:S={}}){const{showSuccess:U,showError:F,showWarning:T}=x(),{flash:A}=s().props,[I,$]=a.useState(S?.search||""),[M,z]=a.useState(S?.type||""),[E,D]=a.useState(S?.status||"");a.useEffect(()=>{A?.success&&U(A.success),A?.error&&F(A.error),A?.warning&&T(A.warning)},[A,U,F,T]);const K=e=>{try{window.open(`/admin/progress-upload/template/${e}`,"_blank"),U(`${e.charAt(0).toUpperCase()+e.slice(1)} template downloaded successfully`)}catch(s){F("Failed to download template. Please try again.")}},L=s=>{switch(s){case"completed":return e.jsx(p,{className:"w-5 h-5 text-green-500"});case"processing":return e.jsx(P,{className:"w-5 h-5 text-yellow-500"});case"failed":return e.jsx(m,{className:"w-5 h-5 text-red-500"});default:return e.jsx(d,{className:"w-5 h-5 text-gray-500"})}};return e.jsxs(i,{children:[e.jsx(r,{title:"Progress Upload Management"}),e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Progress Upload Management"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Upload and manage KPI progress data and milestone updates"})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 flex space-x-2",children:[e.jsxs(f,{variant:"outline",onClick:()=>K("kpi_progress"),children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"KPI Template"]}),e.jsx(t,{href:"/admin/progress-upload/create",children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4"}),"Upload Data"]})})]})]})}),e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.05},className:"mb-6",children:e.jsxs(u,{children:[e.jsxs(g,{children:[e.jsx(h,{children:"Download Templates"}),e.jsx(j,{children:"Download Excel templates for different data types"})]}),e.jsx(y,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(f,{variant:"outline",className:"h-auto p-4 flex flex-col items-center space-y-2",onClick:()=>K("kpi_progress"),children:[e.jsx(n,{className:"w-8 h-8 text-blue-500"}),e.jsx("span",{className:"font-medium",children:"KPI Progress Template"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Update KPI current values"})]}),e.jsxs(f,{variant:"outline",className:"h-auto p-4 flex flex-col items-center space-y-2",onClick:()=>K("milestone_progress"),children:[e.jsx(n,{className:"w-8 h-8 text-green-500"}),e.jsx("span",{className:"font-medium",children:"Milestone Template"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Update milestone progress"})]})]})})]})}),e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"mb-6",children:e.jsx(u,{children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Search Uploads"}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search uploads...",value:I,onChange:e=>$(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type"}),e.jsxs("select",{value:M,onChange:e=>z(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"kpi_progress",children:"KPI Progress"}),e.jsx("option",{value:"milestone_progress",children:"Milestone Progress"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{value:E,onChange:e=>D(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"pending",children:"Pending"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(f,{onClick:()=>{l.get("/admin/progress-upload",{search:I,type:M,status:E},{preserveState:!0,preserveScroll:!0})},className:"w-full",children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Apply Filters"]})})]})})})}),e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"space-y-4",children:C?.data?.map((s,a)=>{return e.jsx(N.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2+.1*a},children:e.jsx(u,{className:"hover:shadow-lg transition-all duration-300",children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[L(s.status),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s.original_filename}),(i=s.file_type,e.jsx(c,{className:{kpi_progress:"bg-blue-100 text-blue-800",milestone_update:"bg-green-100 text-green-800",bulk_data:"bg-purple-100 text-purple-800"}[i]||"bg-gray-100 text-gray-800",children:i.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())})),(r=s.status,e.jsx(c,{className:{completed:"bg-green-100 text-green-800",processing:"bg-yellow-100 text-yellow-800",failed:"bg-red-100 text-red-800",pending:"bg-gray-100 text-gray-800"}[r]||"bg-gray-100 text-gray-800",children:r.charAt(0).toUpperCase()+r.slice(1)}))]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Records:"})," ",s.records_processed||0]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Processed:"})," ",s.records_processed||0]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Errors:"})," ",s.errors_count||0]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Size:"})," ",s.file_size?(s.file_size/1024/1024).toFixed(2)+" MB":"N/A"]})]}),e.jsxs("div",{className:"mt-3 text-sm text-gray-500",children:["Uploaded: ",new Date(s.created_at).toLocaleString()," by ",s.uploader?.name]}),s.error_details&&s.error_details.length>0&&e.jsx("div",{className:"mt-3 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-700 dark:text-red-300",children:["Error: ",s.error_details[0].error||"Processing failed"]})}),"completed"===s.status&&s.records_processed>0&&e.jsx("div",{className:"mt-3 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-700 dark:text-green-300",children:["Successfully processed ",s.records_processed," records",s.errors_count>0&&` with ${s.errors_count} errors`]})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>window.open(`/storage/${s.file_path}`,"_blank"),children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Download"]}),e.jsx(t,{href:`/admin/progress-upload/${s.id}`,children:e.jsxs(f,{variant:"outline",size:"sm",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"View"]})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>(e=>{confirm("Are you sure you want to delete this upload?")&&l.delete(`/admin/progress-upload/${e.id}`,{onSuccess:()=>{U("Upload deleted successfully")},onError:e=>{F("Failed to delete upload. Please try again.")}})})(s),className:"text-red-600 hover:text-red-700",children:e.jsx(_,{className:"w-4 h-4"})})]})]})})})},s.id);var r,i})}),(!C?.data||0===C.data.length)&&e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"text-center py-12",children:[e.jsx(d,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No Uploads Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Upload your first data file to update KPI progress."}),e.jsx(t,{href:"/admin/progress-upload/create",children:e.jsxs(f,{children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Upload First File"]})})]}),C?.links&&C.links.length>3&&e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"mt-8 flex justify-center",children:e.jsx("div",{className:"flex space-x-2",children:C.links.filter(e=>e&&"object"==typeof e).map((s,a)=>{const r=s.url&&"string"==typeof s.url&&""!==s.url.trim(),l=Boolean(s.active),i=s.label&&"string"==typeof s.label?s.label:"";return r||l?r?e.jsx(t,{href:s.url??"#",className:"px-3 py-2 text-sm rounded-lg transition-colors "+(l?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-300"),dangerouslySetInnerHTML:{__html:i}},`link-${a}`):e.jsx("span",{className:"px-3 py-2 text-sm rounded-lg bg-blue-600 text-white",dangerouslySetInnerHTML:{__html:i}},`active-${a}`):e.jsx("span",{className:"px-3 py-2 text-sm rounded-lg bg-gray-100 text-gray-400 cursor-not-allowed",dangerouslySetInnerHTML:{__html:i}},`disabled-${a}`)})})})]})]})}export{C as default};
