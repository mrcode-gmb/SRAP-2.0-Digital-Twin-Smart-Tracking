import{j as e}from"./ui-BB-Ns5TH.js";import{r as s,H as a,L as t,d as l}from"./inertia-Cj_WjKpf.js";import{A as i,B as n,b as r,a as c}from"./AuthenticatedLayout-BBLrwm4R.js";import{M as d}from"./Modal-CefR03wM.js";import{C as m,b as x,c as o,a as h}from"./Card-Ds6DZKCN.js";import{B as j}from"./Button-WmfceJNP.js";import{A as g}from"./arrow-left-Dg9xWZOv.js";import{T as N}from"./trash-2-DstgOvVN.js";import{c as p}from"./app-CZ5g9MqA.js";import{U as f,C as u,B as v}from"./users-Vk9iYAaE.js";import{C as y}from"./clock-CUBuh0Xb.js";import"./vendor-vi784Xxu.js";import"./utils-54zDqgmH.js";import"./house-CIkpS4mx.js";import"./shield-BVGIsKr8.js";import"./zap-BuVIDKNS.js";import"./motion-CkVjjaNW.js";import"./transition-BMZY_FM7.js";
/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=p("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);function w({conversation:p,sessionConversations:w}){const[C,_]=s.useState(!1),A=e=>new Date(e).toLocaleString(),S=()=>{_(!1)},D=s=>{const a=s>1?s:Math.round(100*s);return s>=.8||s>1&&s>=80?e.jsxs(c,{className:"bg-green-100 text-green-800",children:["High (",a,"%)"]}):s>=.6||s>1&&s>=60?e.jsxs(c,{className:"bg-yellow-100 text-yellow-800",children:["Medium (",a,"%)"]}):e.jsxs(c,{className:"bg-red-100 text-red-800",children:["Low (",a,"%)"]})};return e.jsxs(i,{children:[e.jsx(a,{title:"Chatbot Conversation Details"}),e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:flex sm:items-center",children:[e.jsxs("div",{className:"sm:flex-auto",children:[e.jsx("div",{className:"flex items-center gap-3 mb-4",children:e.jsxs(t,{href:route("admin.chatbot.index"),className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700",children:[e.jsx(g,{className:"w-4 h-4 mr-1"}),"Back to Conversations"]})}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Conversation Details"}),e.jsxs("p",{className:"mt-2 text-sm text-gray-700",children:["Session ID: ",e.jsx("span",{className:"font-mono text-xs bg-gray-100 px-2 py-1 rounded",children:p.session_id})]})]}),e.jsx("div",{className:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none",children:e.jsxs(j,{onClick:()=>{_(!0)},variant:"destructive",className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Delete Conversation"]})})]}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-5 h-5"}),"Conversation Thread"]})}),e.jsx(h,{className:"space-y-4",children:w.map((s,a)=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(f,{className:"w-4 h-4 text-blue-600"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"bg-blue-50 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-gray-900",children:s.user_message})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.user?.name||"User"," • ",A(s.created_at)]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(n,{className:"w-4 h-4 text-green-600"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"bg-green-50 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-gray-900",children:s.bot_response})}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["SRAP AI Assistant • ",A(s.created_at)]}),s.confidence_score&&D(s.confidence_score)]})]})]}),a<w.length-1&&e.jsx("div",{className:"border-t border-gray-100 my-4"})]},s.id))})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5"}),"Conversation Info"]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Intent"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:p.intent||"Not detected"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Response Type"}),e.jsx("div",{className:"mt-1",children:(k=p.response_type,e.jsx(c,{className:{informational:"bg-blue-100 text-blue-800",analytical:"bg-purple-100 text-purple-800",actionable:"bg-green-100 text-green-800",clarification:"bg-orange-100 text-orange-800"}[k]||"bg-gray-100 text-gray-800",children:k?.charAt(0).toUpperCase()+k?.slice(1)||"Unknown"}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Confidence Score"}),e.jsx("div",{className:"mt-1",children:p.confidence_score?D(p.confidence_score):"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"IP Address"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1 font-mono",children:p.ip_address||"Not recorded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Created"}),e.jsxs("p",{className:"text-sm text-gray-900 mt-1 flex items-center gap-1",children:[e.jsx(y,{className:"w-3 h-3"}),A(p.created_at)]})]})]})]}),(p.entities||p.context)&&e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5"}),"Analysis Data"]})}),e.jsxs(h,{className:"space-y-4",children:[p.entities&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Entities"}),e.jsx("div",{className:"mt-1",children:e.jsx("pre",{className:"text-xs bg-gray-50 p-2 rounded border overflow-x-auto",children:JSON.stringify(p.entities,null,2)})})]}),p.context&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Context"}),e.jsx("div",{className:"mt-1",children:e.jsx("pre",{className:"text-xs bg-gray-50 p-2 rounded border overflow-x-auto",children:JSON.stringify(p.context,null,2)})})]})]})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsx(o,{children:"Session Statistics"})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Messages:"}),e.jsx("span",{className:"text-sm font-medium",children:w.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Session Duration:"}),e.jsx("span",{className:"text-sm font-medium",children:w.length>1?`${Math.round((new Date(w[w.length-1].created_at)-new Date(w[0].created_at))/6e4)} min`:"Single message"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Avg Confidence:"}),e.jsx("span",{className:"text-sm font-medium",children:w.filter(e=>e.confidence_score).length>0?`${Math.round(w.reduce((e,s)=>e+(s.confidence_score||0),0)/w.filter(e=>e.confidence_score).length*100)}%`:"N/A"})]})]})})]})]})]})]}),e.jsx(d,{show:C,onClose:S,maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(r,{className:"w-6 h-6 text-red-600"})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Delete Conversation"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Are you sure you want to delete this conversation? This action cannot be undone and will remove all messages in this session."}),e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Session: ",p.session_id]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[w.length," message",1!==w.length?"s":""," will be deleted"]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(j,{variant:"outline",onClick:S,children:"Cancel"}),e.jsxs(j,{variant:"destructive",onClick:()=>{l.delete(`/admin/chatbot/${p.id}`,{onSuccess:()=>{l.visit("/admin/chatbot")}})},className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Delete Conversation"]})]})]})})]});var k}export{w as default};
