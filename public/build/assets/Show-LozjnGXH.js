import{j as e}from"./ui--EPVQjIL.js";import{r as s,H as t,d as a,L as r}from"./inertia-Cj_WjKpf.js";import{A as l,F as i,C as d}from"./AuthenticatedLayout-CNFEg6iD.js";import{m as n}from"./motion-CwjCYErC.js";import{U as c}from"./users-DMjQylpi.js";import{E as o}from"./eye-XP_JrV8f.js";import{R as m}from"./refresh-cw-B0Ah55bV.js";import{D as x}from"./download-BfEul8Kz.js";import{F as h}from"./file-spreadsheet-BfWU_IsQ.js";import{b as p,C as j}from"./app-zQQ8YRVW.js";import{C as g}from"./clock-DrprOG_9.js";import{F as f}from"./funnel-DeKx3Jas.js";import{A as u}from"./arrow-left-BWXNK85K.js";import"./vendor-vi784Xxu.js";import"./utils-54zDqgmH.js";import"./Button-DAnlAX8y.js";import"./house-3kGYvX-w.js";import"./shield-CzCE4YeH.js";function y({auth:y,report:N}){const[b,w]=s.useState({pdf:!1,excel:!1}),v=async e=>{if(N.pdf_path||N.excel_path){w(s=>({...s,[e]:!0}));try{const s=await fetch(`/admin/reports/${N.id}/download/${e}`,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});if(!s.ok)throw new Error("Download failed");const t=await s.blob(),r=window.URL.createObjectURL(t),l=document.createElement("a");l.href=r,l.download=`${N.title}_${e}.${"pdf"===e?"pdf":"xlsx"}`,document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(r),a.reload({only:["report"]})}catch(s){alert("Failed to download report. Please try again.")}finally{w(s=>({...s,[e]:!1}))}}else alert("No files available for download yet. Please wait for report generation to complete.")},_=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs(l,{user:y.user,header:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(r,{href:"/admin/reports",className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(u,{className:"w-5 h-5 mr-2"}),"Back to Reports"]}),e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Report Details"})]})}),children:[e.jsx(t,{title:`Report: ${N.title}`}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white overflow-hidden shadow-xl sm:rounded-lg",children:[e.jsx("div",{className:"px-6 py-8 border-b border-gray-200",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:N.title}),e.jsxs("div",{className:"flex items-center space-x-2",children:[(s=>{switch(s){case"completed":return e.jsx(j,{className:"w-5 h-5 text-green-500"});case"generating":return e.jsx(m,{className:"w-5 h-5 text-blue-500 animate-spin"});case"failed":return e.jsx(p,{className:"w-5 h-5 text-red-500"});default:return e.jsx(g,{className:"w-5 h-5 text-yellow-500"})}})(N.status),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${(e=>{switch(e){case"completed":return"bg-green-100 text-green-800";case"generating":return"bg-blue-100 text-blue-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-yellow-100 text-yellow-800"}})(N.status)}`,children:N.status.charAt(0).toUpperCase()+N.status.slice(1)})]})]}),N.description&&e.jsx("p",{className:"text-gray-600 text-lg mb-6",children:N.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(i,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Type"}),e.jsx("p",{className:"font-medium",children:(R=N.type,{kpi_summary:"KPI Summary",pillar_progress:"Pillar Progress",department_performance:"Department Performance",milestone_status:"Milestone Status",comprehensive:"Comprehensive Report"}[R]||R)})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(d,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Period"}),e.jsxs("p",{className:"font-medium",children:[_(N.start_date)," - ",_(N.end_date)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(c,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Generated By"}),e.jsx("p",{className:"font-medium",children:N.generator?.name||"System"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(o,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Downloads"}),e.jsx("p",{className:"font-medium",children:N.download_count||0})]})]})]})]})})}),e.jsxs("div",{className:"px-6 py-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Download Report"}),"completed"===N.status?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[N.pdf_path&&e.jsxs(n.div,{whileHover:{scale:1.02},className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(i,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"PDF Report"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Formatted for printing and viewing"})]})]})}),e.jsxs("button",{onClick:()=>v("pdf"),disabled:b.pdf,className:"w-full flex items-center justify-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[b.pdf?e.jsx(m,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(x,{className:"w-4 h-4 mr-2"}),b.pdf?"Downloading...":"Download PDF"]})]}),N.excel_path&&e.jsxs(n.div,{whileHover:{scale:1.02},className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(h,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Excel Report"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Data for analysis and manipulation"})]})]})}),e.jsxs("button",{onClick:()=>v("excel"),disabled:b.excel,className:"w-full flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[b.excel?e.jsx(m,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(x,{className:"w-4 h-4 mr-2"}),b.excel?"Downloading...":"Download Excel"]})]})]}):"generating"===N.status?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(m,{className:"w-12 h-12 text-blue-500 animate-spin mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Generating Report"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while your report is being generated..."})]}):"failed"===N.status?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(p,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Generation Failed"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"There was an error generating your report."}),e.jsx("button",{onClick:()=>a.post(`/admin/reports/${N.id}/regenerate`),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(g,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Report Pending"}),e.jsx("p",{className:"text-gray-600",children:"Your report is queued for generation."})]})]}),N.filters&&Object.keys(N.filters).length>0&&e.jsxs("div",{className:"px-6 py-8 border-t border-gray-200",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Report Filters"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(f,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Applied Filters:"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[N.filters.pillar_ids&&N.filters.pillar_ids.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Pillars:"})," ",N.filters.pillar_ids.length," selected"]}),N.filters.department_ids&&N.filters.department_ids.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Departments:"})," ",N.filters.department_ids.length," selected"]}),N.filters.kpi_ids&&N.filters.kpi_ids.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"KPIs:"})," ",N.filters.kpi_ids.length," selected"]})]})]})]}),N.generated_at&&e.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:["Generated on: ",_(N.generated_at)]}),e.jsxs("span",{children:["Report ID: #",N.id]})]})})]})})})]});var R}export{y as default};
