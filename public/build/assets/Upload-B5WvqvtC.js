import{j as e}from"./ui--EPVQjIL.js";import{r as s,b as a,u as r,H as t}from"./inertia-Cj_WjKpf.js";import{A as l,U as i,C as d}from"./AuthenticatedLayout-CNFEg6iD.js";import{u as c,C as n,a as o}from"./app-zQQ8YRVW.js";import{C as x,a as m,b as p,c as h,d as u}from"./Card-BDwu8o3f.js";import{B as j}from"./Button-DAnlAX8y.js";import{C as f}from"./clock-DrprOG_9.js";import{F as g}from"./file-spreadsheet-BfWU_IsQ.js";import{D as v}from"./download-BfEul8Kz.js";import{T as N}from"./users-DMjQylpi.js";import"./vendor-vi784Xxu.js";import"./utils-54zDqgmH.js";import"./house-3kGYvX-w.js";import"./shield-CzCE4YeH.js";import"./motion-CwjCYErC.js";function y({auth:y}){const{showSuccess:b,showError:w,showWarning:k}=c(),D=s.useRef(null),[P,C]=s.useState(!1),[I,S]=s.useState(0),[E,U]=s.useState(!1),{data:F,setData:T,post:K,processing:_,errors:B,reset:M}=a({file:null,type:"kpi_progress",overwrite_existing:!1}),{flash:A}=r().props;s.useEffect(()=>{A?.success&&b(A.success),A?.error&&w(A.error),A?.warning&&k(A.warning)},[A,b,w,k]);const V=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?C(!0):"dragleave"===e.type&&C(!1)},z=e=>{if(e){if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(e.type))return void w("Please select an Excel (.xlsx, .xls) or CSV file");if(e.size>10485760)return void w("File size must be less than 10MB");T("file",e),b(`File "${e.name}" selected successfully`)}},O=e=>{window.location.href=`/admin/progress-upload/template/${e}`};return e.jsxs(l,{user:y.user,children:[e.jsx(t,{title:"Upload KPI Data - Data Officer"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Upload KPI Progress Data"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Upload Excel or CSV files with KPI progress data for review and approval"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(x,{children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(i,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Ready to Upload"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:F.file?"1 File":"No File"})]})]})})}),e.jsx(x,{children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(f,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Pending Approval"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"-"})]})]})})}),e.jsx(x,{children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(n,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Approved Today"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"-"})]})]})})})]}),e.jsxs(x,{className:"mb-8",children:[e.jsxs(p,{children:[e.jsxs(h,{className:"flex items-center",children:[e.jsx(i,{className:"w-5 h-5 mr-2"}),"Upload KPI Progress Data"]}),e.jsx(u,{children:"Select an Excel or CSV file containing KPI progress updates"})]}),e.jsx(m,{children:e.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!F.file)return void w("Please select a file to upload");U(!0),S(0);const s=setInterval(()=>{S(e=>e>=90?(clearInterval(s),e):e+10)},200);K("/admin/progress-upload",{onSuccess:()=>{clearInterval(s),S(100),M(),U(!1),D.current&&(D.current.value="")},onError:()=>{clearInterval(s),S(0),U(!1),w("Upload failed. Please try again.")}})},className:"space-y-6",children:[e.jsxs("div",{className:"relative border-2 border-dashed rounded-lg p-8 text-center transition-colors "+(P?"border-blue-400 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400"),onDragEnter:V,onDragLeave:V,onDragOver:V,onDrop:e=>{e.preventDefault(),e.stopPropagation(),C(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&z(e.dataTransfer.files[0])},children:[e.jsx("input",{ref:D,type:"file",accept:".xlsx,.xls,.csv",onChange:e=>z(e.target.files[0]),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:e.jsx(g,{className:"w-8 h-8 text-gray-400"})}),F.file?e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-gray-900 dark:text-white",children:F.file.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[(F.file.size/1024/1024).toFixed(2)," MB"]})]}):e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Drop your file here, or click to browse"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Supports Excel (.xlsx, .xls) and CSV files up to 10MB"})]})]})]}),B.file&&e.jsxs("div",{className:"flex items-center text-red-600 text-sm",children:[e.jsx(o,{className:"w-4 h-4 mr-2"}),B.file]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Data Type"}),e.jsxs("select",{value:F.type,onChange:e=>T("type",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"kpi_progress",children:"KPI Progress Data"}),e.jsx("option",{value:"milestone_progress",children:"Milestone Progress Data"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"overwrite",checked:F.overwrite_existing,onChange:e=>T("overwrite_existing",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"overwrite",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300",children:"Overwrite existing data for the same date"})]})]}),E&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Uploading..."}),e.jsxs("span",{children:[I,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${I}%`}})})]}),e.jsx("div",{className:"flex space-x-4",children:e.jsx(j,{type:"submit",disabled:_||E||!F.file,className:"flex-1",children:_||E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"w-4 h-4 mr-2"}),"Upload Data"]})})})]})})]}),e.jsxs(x,{children:[e.jsxs(p,{children:[e.jsxs(h,{className:"flex items-center",children:[e.jsx(v,{className:"w-5 h-5 mr-2"}),"Download Templates"]}),e.jsx(u,{children:"Download Excel templates with the correct format for data upload"})]}),e.jsx(m,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{onClick:()=>O("kpi_progress"),variant:"outline",className:"flex items-center justify-center p-4 h-auto",children:e.jsxs("div",{className:"text-center",children:[e.jsx(N,{className:"w-8 h-8 mx-auto mb-2 text-blue-600"}),e.jsx("div",{className:"font-medium",children:"KPI Progress Template"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Excel format for KPI updates"})]})}),e.jsx(j,{onClick:()=>O("milestone_progress"),variant:"outline",className:"flex items-center justify-center p-4 h-auto",children:e.jsxs("div",{className:"text-center",children:[e.jsx(d,{className:"w-8 h-8 mx-auto mb-2 text-green-600"}),e.jsx("div",{className:"font-medium",children:"Milestone Template"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Excel format for milestone updates"})]})})]})})]})]})})]})}export{y as default};
