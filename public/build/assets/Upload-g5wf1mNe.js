import{j as e}from"./ui--EPVQjIL.js";import{r as s,b as a,H as r}from"./inertia-Cj_WjKpf.js";import{A as t,U as l,C as i}from"./AuthenticatedLayout-BYa0DHjr.js";import{u as d,C as c,a as n}from"./app-DVdO48kI.js";import{C as o,a as x,b as m,c as p,d as h}from"./Card-BDwu8o3f.js";import{B as u}from"./Button-DAnlAX8y.js";import{C as j}from"./clock-BjQsYuAX.js";import{F as f}from"./file-spreadsheet-CzwL-iy4.js";import{D as g}from"./download-CAfWJy6P.js";import{T as v}from"./users-Bfxi8K-c.js";import"./vendor-vi784Xxu.js";import"./utils-54zDqgmH.js";import"./house-gbNKmPpv.js";import"./shield-BjG87K2N.js";import"./zap-_fnpzzFy.js";import"./motion-CwjCYErC.js";function N({auth:N}){const{showSuccess:y,showError:b,showWarning:w}=d(),k=s.useRef(null),[D,P]=s.useState(!1),[C,I]=s.useState(0),[S,E]=s.useState(!1),{data:F,setData:U,post:T,processing:K,errors:_,reset:A}=a({file:null,type:"kpi_progress",overwrite_existing:!1}),B=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?P(!0):"dragleave"===e.type&&P(!1)},M=e=>{if(e){if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(e.type))return void b("Please select an Excel (.xlsx, .xls) or CSV file");if(e.size>10485760)return void b("File size must be less than 10MB");U("file",e),y(`File "${e.name}" selected successfully`)}},z=e=>{window.location.href=`/admin/progress-upload/template/${e}`};return e.jsxs(t,{user:N.user,children:[e.jsx(r,{title:"Upload KPI Data - Data Officer"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Upload KPI Progress Data"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Upload Excel or CSV files with KPI progress data for review and approval"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(o,{children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(l,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Ready to Upload"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:F.file?"1 File":"No File"})]})]})})}),e.jsx(o,{children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(j,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Pending Approval"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"-"})]})]})})}),e.jsx(o,{children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(c,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Approved Today"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"-"})]})]})})})]}),e.jsxs(o,{className:"mb-8",children:[e.jsxs(m,{children:[e.jsxs(p,{className:"flex items-center",children:[e.jsx(l,{className:"w-5 h-5 mr-2"}),"Upload KPI Progress Data"]}),e.jsx(h,{children:"Select an Excel or CSV file containing KPI progress updates"})]}),e.jsx(x,{children:e.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!F.file)return void b("Please select a file to upload");E(!0),I(0);const s=setInterval(()=>{I(e=>e>=90?(clearInterval(s),e):e+10)},200);T("/admin/progress-upload",{onSuccess:e=>{clearInterval(s),I(100),y("File uploaded successfully! Awaiting HOD approval."),A(),E(!1),k.current&&(k.current.value="")},onError:e=>{clearInterval(s),I(0),E(!1),b("Upload failed. Please try again.")}})},className:"space-y-6",children:[e.jsxs("div",{className:"relative border-2 border-dashed rounded-lg p-8 text-center transition-colors "+(D?"border-blue-400 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400"),onDragEnter:B,onDragLeave:B,onDragOver:B,onDrop:e=>{e.preventDefault(),e.stopPropagation(),P(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&M(e.dataTransfer.files[0])},children:[e.jsx("input",{ref:k,type:"file",accept:".xlsx,.xls,.csv",onChange:e=>M(e.target.files[0]),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:e.jsx(f,{className:"w-8 h-8 text-gray-400"})}),F.file?e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-gray-900 dark:text-white",children:F.file.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[(F.file.size/1024/1024).toFixed(2)," MB"]})]}):e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Drop your file here, or click to browse"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Supports Excel (.xlsx, .xls) and CSV files up to 10MB"})]})]})]}),_.file&&e.jsxs("div",{className:"flex items-center text-red-600 text-sm",children:[e.jsx(n,{className:"w-4 h-4 mr-2"}),_.file]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Data Type"}),e.jsxs("select",{value:F.type,onChange:e=>U("type",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"kpi_progress",children:"KPI Progress Data"}),e.jsx("option",{value:"milestone_progress",children:"Milestone Progress Data"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"overwrite",checked:F.overwrite_existing,onChange:e=>U("overwrite_existing",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"overwrite",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300",children:"Overwrite existing data for the same date"})]})]}),S&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Uploading..."}),e.jsxs("span",{children:[C,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${C}%`}})})]}),e.jsx("div",{className:"flex space-x-4",children:e.jsx(u,{type:"submit",disabled:K||S||!F.file,className:"flex-1",children:K||S?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{className:"w-4 h-4 mr-2"}),"Upload Data"]})})})]})})]}),e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsxs(p,{className:"flex items-center",children:[e.jsx(g,{className:"w-5 h-5 mr-2"}),"Download Templates"]}),e.jsx(h,{children:"Download Excel templates with the correct format for data upload"})]}),e.jsx(x,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(u,{onClick:()=>z("kpi_progress"),variant:"outline",className:"flex items-center justify-center p-4 h-auto",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"w-8 h-8 mx-auto mb-2 text-blue-600"}),e.jsx("div",{className:"font-medium",children:"KPI Progress Template"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Excel format for KPI updates"})]})}),e.jsx(u,{onClick:()=>z("milestone_progress"),variant:"outline",className:"flex items-center justify-center p-4 h-auto",children:e.jsxs("div",{className:"text-center",children:[e.jsx(i,{className:"w-8 h-8 mx-auto mb-2 text-green-600"}),e.jsx("div",{className:"font-medium",children:"Milestone Template"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Excel format for milestone updates"})]})})]})})]})]})})]})}export{N as default};
